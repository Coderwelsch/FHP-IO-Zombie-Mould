<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">

        <title>Zombie Mould - Eingabe / Ausgabe</title>

        <style>
            * {
                margin: 0;
                padding: 0;
            }

            html, body, #google-map {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>

    <body>
        <div id="google-map"></div>

        <!-- scripts -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="http://plugins.coderwelsch.com/com.cw.GoogleMap.js"></script>
        <script type="text/javascript" src="files/js/markerclusterer.min.js"></script>

        <script type="text/javascript">
            var cities = {
                    'Berlin': { lat: 52.520007, lng: 13.404954 },
                    'Hamburg': { lat: 53.551085, lng: 9.993682 },
                    'Hannover': { lat: 52.375892, lng: 9.732010 },
                    'Bremen': { lat: 53.079296, lng: 8.801694 },
                    'Düsseldorf': { lat: 51.227741, lng: 6.773456 },
                    'Leipzig': { lat: 51.339695, lng: 12.373075 },
                    'München': { lat: 48.135125, lng: 11.581981 },
                    'Köln': { lat: 50.937531, lng: 6.960279 },
                    'Frankfurt am Main': { lat: 50.110922, lng: 8.682127 }
                },

                iconURL = 'http://vignette2.wikia.nocookie.net/farmville/images/f/f9/Oatmeal_Cookies-icon.png/revision/latest?cb=20100721014411';

                _gMap = new com.cw.GoogleMap( {
                    $container: $( '#google-map' ),
                    mapSettings: {
                        zoom: 6,
                        center: { lat: 51.165691, lng: 10.451526 },
                        styles: [{"featureType":"all","elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#000000"},{"lightness":40}]},{"featureType":"all","elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#000000"},{"lightness":16}]},{"featureType":"all","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":17},{"weight":1.2}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":21}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":16}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":19}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":17}]}]
                    },

                    onMapLoaded: mapLoaded
                } );

            function displayCities () {
                var markers = [];
                for ( var key in cities ) {
                    var item = cities[ key ],
                        marker = new google.maps.Marker({
                            position: item,
                            map: _gMap.googleMap,
                            title: key,
                            icon: {
                                url: iconURL,
                                origin: new google.maps.Point( 0, 0 ),
                                anchor: new google.maps.Point( 35, 35 ),
                                size: new google.maps.Size( 70, 70 ),
                                scaledSize: new google.maps.Size( 70, 70 )
                            }
                        } ),
                        infoWindow = new google.maps.InfoWindow( {
                            content: '<h3>' + key + '</h3>'
                        } );

                    marker.content = '<h3>' + key + '</h3>';

                    google.maps.event.addListener( marker, 'click', function() {
                        infoWindow.setContent( this.content );
                        infoWindow.open( _gMap.googleMap, this );
                    });

                    markers.push( marker );
                }
            }

            function mapLoaded () {
                displayCities();

                $.getJSON( 'files/json/cachedURLs.json', function ( data ) {
                    var markers = [];

                    for ( var key in data ) {
                        var item = data[ key ],
                            marker = new google.maps.Marker( {
                                position: { lat: parseFloat( item.lat ), lng: parseFloat( item.lng ) },
                                map: _gMap.googleMap,
                                title: 'Hello World!'
                            } );

                        markers.push( marker );
                    }

                    if ( getURLParameter( window.location.href, 'cluster' ) !== 'false' ) {
                        var cluster = new MarkerClusterer( _gMap.googleMap, markers, {} ),
                            clusterMarkers = cluster.getMarkers();

                            window.test = clusterMarkers;

                        /*for ( var i = 0; i < 20 - 1; i++ ) {
                            var marker1 = clusterMarkers[ i ],
                                marker2 = clusterMarkers[ i + 1 ];

                            if ( marker1 && marker2 ) {
                                var path = new google.maps.Polyline( {
                                    path: [ marker1.getPosition(), marker2.getPosition() ],
                                    geodesic: true,
                                    strokeColor: '#FF0000',
                                    strokeOpacity: 0.5,
                                    strokeWeight: 3
                                } );

                                path.setMap( _gMap.googleMap );
                            }
                        }*/
                    } else {
                    }
                } );
            }

            function getURLParameter ( url, name ) {
                return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec( url )||[,""])[1].replace(/\+/g, '%20'))||null
            }
        </script>
    </body>
</html>